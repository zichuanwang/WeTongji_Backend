<% @title = "管理员" %>
<% @description = "系统管理员" %>
<% @controller = "管理员" %>
<% @action = "列表" %>

<div class="portlet box light-grey">
    <div class="portlet-title">
        <div class="caption"><i class="icon-group"></i>所有管理账号</div>
    </div>
    <div class="portlet-body">
        <table class="table table-hover">
            <thead>
                <tr>
                  <th>Email</th>
                  <th>姓名</th>
                  <th>学号</th>
                  <th>角色</th>
                  <th>显示名</th>
                  <th>登陆</th>
                  <th>新闻/活动/咨询</th>
                  <th></th>
                </tr>
            </thead>
            <tbody>
              <% @admins.each do |admin| %>
              <tr>
                  <td><%= admin.email %></td>
                  <td><%= admin.name %></td>
                  <td><%= admin.student_no %></td>
                  <td><%= role_name(admin.role) %></td>
                  <td><%= admin.display %></td>
                  <td><%= admin.sign_in_count %></td>
                  <td><%= admin.news.size %>/<%= admin.activities.size %>/<%= admin.information.size %></td>
                  <td>
                    <% unless admin.locked_at.nil? %>
                        <span class="label label-info">已锁定</span>
                    <% else %>
                        <span class="label label-success">正常</span>
                    <% end %>
                  </td>
                  <td>
                    <%= link_to '详情', admin %>
                    <%= link_to '编辑', edit_admin_path(admin) %>
                    <% if admin.approved_at.nil? %>
                    <%= link_to '审批', admins_approve_path(:id => admin.id), confirm: '确认审批?', method: :post %>
                    <% else %>
                    <% if admin.locked_at.nil? %>
                    <%= link_to '禁用', admins_lock_path(:id => admin.id), confirm: '确认禁用?', method: :post %>
                    <% else %>
                    <%= link_to '启用', admins_unlock_path(:id => admin.id), confirm: '确认启用?', method: :post %>
                    <% end %>
                    <% end %>
                    <% if admin.can_destroy %>
                    <%= link_to '删除', admin, confirm: '确认删除?', method: :delete %>
                    <% end %>
                  </td>
              </tr>
              <% end %>
            </tbody>
        </table>
        <%= paginate @admins %>
    </div>
    
</div>